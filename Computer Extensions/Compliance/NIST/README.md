# 🛡️ NIST Compliance — Extension Attributes

This folder contains Extension Attributes that help Jamf Pro administrators monitor **NIST-aligned macOS security baselines** using results generated by the macOS Security Compliance Project (mSCP).

---

## 📄 Included EA

### `failed_compliance_list.sh`
Reports the **list of failed mSCP controls** on a device, automatically excluding any items that are marked as **exempt** in the managed audit plist. The output is a newline‑separated list wrapped in a Jamf EA `<result>…</result>` block. fileciteturn19file0

**How it works (high level):**
- Locates the active audit plist (managed or local) and parses rule results.
- Builds two sets: **FAILED** controls and **EXEMPT** controls.
- Returns only failed controls **not** listed as exemptions, sorted alphabetically.

**Example EA result (trimmed):**
```xml
<result>
macos_loginwindow_loginwindow_configure_loginwindow_text
pwpolicy_password_length_enforce_minimum
...
</result>
```

---

## 🔧 Jamf Pro Setup

1. **Settings → Computer Management → Extension Attributes → New**  
2. **Input Type:** *Script*  
3. **Data Type:** *String* (multi‑line allowed)  
4. Paste the contents of `failed_compliance_list.sh` and **Save**.  
5. Run an **Inventory Update** on a test Mac to verify the EA value in the computer record.

> Tip: Scope a **Smart Computer Group** to devices where the EA **is not** `No Baseline Set` and **does not match** `^$` to focus on machines with actionable failures.

---

## 🧠 Smart Group Examples

- **Devices with any failed controls**
  - *Criterion:* `Failed Compliance List` **does not match** `^$`

- **Devices without a baseline configured**
  - *Criterion:* `Failed Compliance List` **is** `No Baseline Set`

- **Devices with specific failed control (e.g., password length)**
  - *Criterion:* `Failed Compliance List` **contains** `pwpolicy_password_length_enforce_minimum`

---

## 🩺 Troubleshooting

- **EA shows “Multiple Baselines Found”**  
  More than one audit plist detected. Ensure a single mSCP baseline is active on the Mac.

- **EA shows “No Baseline Set”**  
  Deploy your mSCP baseline first; the audit plist must exist for this EA to return data.

- **No exemptions honored**  
  Confirm exemptions are set in the *managed* audit plist; unmanaged/local plists may override if the managed file is missing.

---

## ⚠️ Notes

- Designed for environments using the **macOS Security Compliance Project** (mSCP).  
- Output is intended for **reporting and scoping**; remediation should be handled by separate policies or scripts.  
- Test on a pilot group before broad deployment.
